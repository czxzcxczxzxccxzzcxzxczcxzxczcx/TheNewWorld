<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=0.75, maximum-scale=1.0, user-scalable=no">

    <link rel="icon" type="image/x-icon" href="/src/TNW.png">

    <link rel="stylesheet" type="text/css" href="styles.css">
    <script>
        // Apply theme immediately to prevent flash
        (function() {
            const savedTheme = localStorage.getItem('theme') || 'auto';
            const html = document.documentElement;
            
            html.classList.remove('theme-light', 'theme-dark', 'theme-auto', 'auto-light', 'auto-dark');
            html.classList.add(`theme-${savedTheme}`);
            
            if (savedTheme === 'auto') {
                const mediaQuery = window.matchMedia('(prefers-color-scheme: dark)');
                if (mediaQuery.matches) {
                    html.classList.add('auto-dark');
                } else {
                    html.classList.add('auto-light');
                }
            }
        })();
    </script>
    <script type="module" src="/js/admin.js" defer></script>

    <title>The New World - Admin Panel</title>
</head>

<body>
    <div class="modernAdminPanel">
        <header class="adminHeader">
            <div class="adminHeaderLeft">
                <button id="backToHome" class="backHomeBtn">â† Back to Home</button>
                <h1>ğŸ›¡ï¸ Admin Control Panel</h1>
            </div>
            <div class="adminUserInfo">
                <span id="adminUserDisplay">Loading...</span>
                <span id="adminRoleBadge" class="roleBadge">Admin</span>
            </div>
        </header>

        <nav class="adminTabs">
            <button class="adminTab active" data-tab="users">ğŸ‘¥ Users</button>
            <button class="adminTab" data-tab="posts">ğŸ“ Posts</button>
            <button class="adminTab" data-tab="comments">ğŸ’¬ Comments</button>
            <button class="adminTab" data-tab="messages">ğŸ“© Messages</button>
            <button class="adminTab" data-tab="permissions" id="permissionsTab" style="display: none;">ğŸ”‘ Permissions</button>
        </nav>

        <main class="adminContent">
            <!-- Users Tab -->
            <section class="adminTabContent active" id="usersTab">
                <div class="adminSearch">
                    <input type="text" id="userSearch" placeholder="Search users by username, ID, or email...">
                    <button id="userSearchBtn">ğŸ” Search</button>
                </div>
                
                <div class="adminActions">
                    <button id="loadAllUsers" class="actionBtn">ğŸ“‹ Load All Users</button>
                    <button id="createUser" class="actionBtn">â• Create User</button>
                </div>
                
                <div id="userResults" class="resultsContainer"></div>
            </section>

            <!-- Posts Tab -->
            <section class="adminTabContent" id="postsTab">
                <div class="adminSearch">
                    <input type="text" id="postSearch" placeholder="Search posts by content, ID, or author...">
                    <button id="postSearchBtn">ğŸ” Search</button>
                </div>
                
                <div class="adminActions">
                    <button id="loadAllPosts" class="actionBtn">ğŸ“‹ Load All Posts</button>
                </div>
                
                <div id="postResults" class="resultsContainer"></div>
            </section>

            <!-- Comments Tab -->
            <section class="adminTabContent" id="commentsTab">
                <div class="adminSearch">
                    <input type="text" id="commentSearch" placeholder="Search comments by content, ID, or author...">
                    <button id="commentSearchBtn">ğŸ” Search</button>
                </div>
                
                <div class="adminActions">
                    <button id="loadAllComments" class="actionBtn">ğŸ“‹ Load All Comments</button>
                </div>
                
                <div id="commentResults" class="resultsContainer"></div>
            </section>

            <!-- Messages Tab -->
            <section class="adminTabContent" id="messagesTab">
                <div class="adminSearch">
                    <input type="text" id="messageSearch" placeholder="Search messages by content, ID, or sender...">
                    <button id="messageSearchBtn">ğŸ” Search</button>
                </div>
                
                <div class="adminActions">
                    <button id="loadAllMessages" class="actionBtn">ğŸ“‹ Load All Messages</button>
                </div>
                
                <div id="messageResults" class="resultsContainer"></div>
            </section>

            <!-- Permissions Tab (Head Admin Only) -->
            <section class="adminTabContent" id="permissionsTab">
                <div class="permissionsSection">
                    <h3>ğŸ‘‘ Admin Management</h3>
                    <div class="adminActions">
                        <button id="loadUsersWithRoles" class="actionBtn">ğŸ“‹ View All User Roles</button>
                    </div>
                    
                    <div class="permissionControls">
                        <div class="permissionGroup">
                            <h4>Grant Admin Permission</h4>
                            <input type="text" id="grantAdminInput" placeholder="Account Number or Username">
                            <button id="grantAdminBtn" class="actionBtn grant">ğŸ›¡ï¸ Grant Admin</button>
                        </div>
                        
                        <div class="permissionGroup">
                            <h4>Revoke Admin Permission</h4>
                            <input type="text" id="revokeAdminInput" placeholder="Account Number or Username">
                            <button id="revokeAdminBtn" class="actionBtn revoke">âŒ Revoke Admin</button>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Edit Modal -->
        <div id="editModal" class="modal">
            <div class="modalContent">
                <div class="modalHeader">
                    <h3 id="modalTitle">Edit Item</h3>
                    <button id="closeModal" class="closeBtn">âœ•</button>
                </div>
                <div class="modalBody">
                    <div id="editForm"></div>
                </div>
                <div class="modalFooter">
                    <button id="saveChanges" class="actionBtn">ğŸ’¾ Save Changes</button>
                    <button id="cancelEdit" class="actionBtn secondary">âŒ Cancel</button>
                </div>
            </div>
        </div>

        <!-- Delete Confirmation Modal -->
        <div id="deleteModal" class="modal">
            <div class="modalContent">
                <div class="modalHeader">
                    <h3>âš ï¸ Confirm Delete</h3>
                    <button id="closeDeleteModal" class="closeBtn">âœ•</button>
                </div>
                <div class="modalBody">
                    <p id="deleteMessage">Are you sure you want to delete this item?</p>
                </div>
                <div class="modalFooter">
                    <button id="confirmDelete" class="actionBtn danger">ğŸ—‘ï¸ Delete</button>
                    <button id="cancelDelete" class="actionBtn secondary">âŒ Cancel</button>
                </div>
            </div>
        </div>
    </div>
</body>

</html>